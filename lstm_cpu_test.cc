#include <iostream>
#include <cstring>
#include "lstm_cpu.h"

int main() {
  const float I[] = {
    +0.0, +0.1, +0.2,
    -0.3, -0.4, -0.5,
    +0.6, +0.7, +0.8,
    -0.9, -1.0, -1.1
  };
  float O[4 * 3 * 1 * 4 * 2];
  float Q[4 * 3 * 1 * 4 * 5 * 2];
  const int S[] = {4, 3};
  float P[] = {
    // Bias
    +0.1, +0.2, +0.3, +0.4, +0.5, +0.6, +0.7, +0.8, +0.9, +1.0,
    -0.1, -0.2, -0.3, -0.4, -0.5, -0.6, -0.7, -0.8, -0.9, -1.0,
    -1.1, -1.2, -1.3, -1.4, -1.5, -1.6, -1.7, -1.8, -1.9, -2.0,
    +1.1, +1.2, +1.3, +1.4, +1.5, +1.6, +1.7, +1.8, +1.9, +2.0,
    // iW
    10.0, -10.0, -20.0, 20.0, -30.0, -30.0, +40.0, +40.0, -50.0, +50.0,
    1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0,
    -1.0, -2.0, -3.0, -4.0, -5.0, -6.0, -7.0, -8.0, -9.0, -10.0,
    0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0,
    // rW
    10.0, -10.0, -20.0, 20.0, -30.0, -30.0, +40.0, +40.0, -50.0, +50.0,
    1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0,
    -1.0, -2.0, -3.0, -4.0, -5.0, -6.0, -7.0, -8.0, -9.0, -10.0,
    0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0,
    10.0, -10.0, -20.0, 20.0, -30.0, -30.0, +40.0, +40.0, -50.0, +50.0,
    1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0,
    -1.0, -2.0, -3.0, -4.0, -5.0, -6.0, -7.0, -8.0, -9.0, -10.0,
    0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0,
    10.0, -10.0, -20.0, 20.0, -30.0, -30.0, +40.0, +40.0, -50.0, +50.0,
    1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0,
    -1.0, -2.0, -3.0, -4.0, -5.0, -6.0, -7.0, -8.0, -9.0, -10.0,
    0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0,
    10.0, -10.0, -20.0, 20.0, -30.0, -30.0, +40.0, +40.0, -50.0, +50.0,
    1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0,
    -1.0, -2.0, -3.0, -4.0, -5.0, -6.0, -7.0, -8.0, -9.0, -10.0,
    0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0,
  };
  memset(P, 0x00, sizeof(float) * 4 * 5 * 2);
  lstm_2d_fwd_cpu< float, Tanh<float>, Tanh<float> >(4, 3, 1, 1, 2, I, S, P, O, Q);
  return 0;
}
